<div class="flex h-screen">
  <!-- Sidebar -->
  <div class="w-1/4 bg-gray-100 p-4 border-r">
    <h2 class="text-xl font-bold mb-4">Filters</h2>
    
    <%= form_with url: tasks_path, method: :get, local: true, class: "space-y-4" do |form| %>
      <!-- Task List Filter -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Task List</label>
        <%= form.select :task_list_id, 
            options_from_collection_for_select(@task_lists, :id, :name, params[:task_list_id]),
            { prompt: "All Lists" },
            { class: "w-full border border-gray-300 rounded-md px-3 py-2" } %>
      </div>
      
      <!-- Urgent Filter -->
      <div>
        <label class="flex items-center">
          <%= form.check_box :urgent, { checked: params[:urgent] == 'true' }, "true", "" %>
          <span class="ml-2 text-sm text-gray-700">Urgent only</span>
        </label>
      </div>
      
      <!-- Important Filter -->
      <div>
        <label class="flex items-center">
          <%= form.check_box :important, { checked: params[:important] == 'true' }, "true", "" %>
          <span class="ml-2 text-sm text-gray-700">Important only</span>
        </label>
      </div>
      
      <!-- Due Date Filter -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Due Date</label>
        <%= form.select :due_date,
            options_for_select([
              ['All', ''],
              ['Overdue', 'overdue'],
              ['Due Today', 'today'],
              ['Due This Week', 'this_week'],
              ['No Due Date', 'no_due_date']
            ], params[:due_date]),
            {},
            { class: "w-full border border-gray-300 rounded-md px-3 py-2" } %>
      </div>
      
      <%= form.submit "Apply Filters", class: "w-full bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600" %>
    <% end %>
    
    <!-- New Task Button -->
    <div class="mt-8">
      <%= link_to "Create New Task", new_task_path, 
          class: "w-full bg-green-500 text-white py-2 px-4 rounded-md hover:bg-green-600 text-center block" %>
    </div>
  </div>
  
  <!-- Main Content -->
  <div class="flex-1 p-6">
    <h1 class="text-3xl font-bold mb-6">Tasks</h1>
    
    <% if @tasks.any? %>
      <div class="space-y-2">
        <% @tasks.each do |task| %>
          <%= render 'task_item', task: task %>
        <% end %>
      </div>
    <% else %>
      <div class="text-gray-500 text-center py-8">
        <p>No tasks found matching your filters.</p>
      </div>
    <% end %>
  </div>
</div>

<script>
  function toggleChildren(taskId) {
    const childrenDiv = document.getElementById('children-' + taskId);
    const toggleButton = document.getElementById('toggle-' + taskId);
    
    if (childrenDiv.style.display === 'none' || childrenDiv.style.display === '') {
      childrenDiv.style.display = 'block';
      toggleButton.textContent = '▼';
    } else {
      childrenDiv.style.display = 'none';
      toggleButton.textContent = '▶';
    }
  }
</script>
